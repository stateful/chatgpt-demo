import { apiCall, apiCallWithUpload } from './util';
const apiURL = 'https://api.openai.com/v1/';
var apiType;
(function (apiType) {
    apiType["Generate"] = "completions";
    apiType["ChatGenerate"] = "chat/completions";
    apiType["Embed"] = "embeddings";
    apiType["Transcribe"] = "audio/transcriptions";
})(apiType || (apiType = {}));
/**
 * OpenAI: Models for text generation
 * @export
 */
export var OpenAIGenerateModel;
(function (OpenAIGenerateModel) {
    OpenAIGenerateModel["GPT4"] = "gpt-4";
    OpenAIGenerateModel["GPT432K"] = "gpt-4-32k";
    OpenAIGenerateModel["GPT3Turbo"] = "gpt-3.5-turbo";
    OpenAIGenerateModel["GPT3TextDavinci003"] = "text-davinci-003";
})(OpenAIGenerateModel || (OpenAIGenerateModel = {}));
/**
 * OpenAI: Models for code generation
 * @export
 */
export var OpenAIGenerateCodeModel;
(function (OpenAIGenerateCodeModel) {
    OpenAIGenerateCodeModel["CodexCodeDavinci002"] = "code-davinci-002";
    OpenAIGenerateCodeModel["CodexCodeCushman001"] = "code-cushman-001";
    OpenAIGenerateCodeModel["CodexCodeDavinci001"] = "code-davinci-001";
})(OpenAIGenerateCodeModel || (OpenAIGenerateCodeModel = {}));
/**
 * OpenAI: Models for use in embeddings
 * @export
 */
export var OpenAIEmbedModels;
(function (OpenAIEmbedModels) {
    OpenAIEmbedModels["GPT3TextEmbeddingAda002"] = "text-embedding-ada-002";
    OpenAIEmbedModels["GPT3TextSimilarityDavinci001"] = "text-similarity-davinci-001";
})(OpenAIEmbedModels || (OpenAIEmbedModels = {}));
/**
 * OpenAI: Models for for audio transcription
 * @export
 */
export var OpenAIAudioModel;
(function (OpenAIAudioModel) {
    OpenAIAudioModel["Whisper1"] = "whisper-1";
})(OpenAIAudioModel || (OpenAIAudioModel = {}));
/**
 * OpenAI: Default Model options for text generation
 * @export
 */
export const OpenAIDefaultOptions = () => ({
    model: OpenAIGenerateModel.GPT3Turbo,
    embedModel: OpenAIEmbedModels.GPT3TextEmbeddingAda002,
    audioModel: OpenAIAudioModel.Whisper1,
    suffix: null,
    maxTokens: 300,
    temperature: 0.45,
    topP: 1,
});
/**
 * OpenAI: Default model options for more creative text generation
 * @export
 */
export const OpenAICreativeOptions = () => ({
    ...OpenAIDefaultOptions(),
    model: OpenAIGenerateModel.GPT3Turbo,
    temperature: 0.9,
});
/**
 * OpenAI: Default model options for more fast text generation
 * @export
 */
export const OpenAIFastOptions = () => ({
    ...OpenAIDefaultOptions(),
    model: OpenAIGenerateModel.GPT3Turbo,
    temperature: 0.45,
});
const generateReq = (prompt, opt, stopSequences) => {
    if (stopSequences?.length > 4) {
        throw new Error('OpenAI supports prompts with max 4 items in stopSequences');
    }
    return {
        model: opt.model,
        prompt: prompt,
        suffix: opt.suffix,
        max_tokens: opt.maxTokens,
        temperature: opt.temperature,
        top_p: opt.topP,
        n: opt.n,
        stream: opt.stream,
        logprobs: opt.logprobs,
        echo: opt.echo,
        stop: stopSequences,
        presence_penalty: opt.presencePenalty,
        frequency_penalty: opt.frequencyPenalty,
        best_of: opt.bestOf,
        logit_bias: opt.logitBias,
        user: opt.user,
    };
};
const generateChatReq = (prompt, opt, stopSequences) => {
    if (stopSequences?.length > 4) {
        throw new Error('OpenAI supports prompts with max 4 items in stopSequences');
    }
    return {
        model: opt.model,
        messages: [{ role: 'user', content: prompt }],
        max_tokens: opt.maxTokens,
        temperature: opt.temperature,
        top_p: opt.topP,
        n: opt.n,
        stream: opt.stream,
        stop: stopSequences,
        presence_penalty: opt.presencePenalty,
        frequency_penalty: opt.frequencyPenalty,
        logit_bias: opt.logitBias,
        user: opt.user,
    };
};
const generateAudioReq = (opt, prompt, language) => {
    return {
        model: opt.audioModel,
        prompt: prompt,
        temperature: opt.temperature,
        language: language,
        response_format: 'verbose_json',
    };
};
/**
 * OpenAI: AI Service
 * @export
 */
export class OpenAI {
    apiKey;
    orgID;
    options;
    constructor(apiKey, options = OpenAIDefaultOptions()) {
        if (apiKey === '') {
            throw new Error('OpenAPI API key not set');
        }
        this.apiKey = apiKey;
        this.options = options;
    }
    name() {
        return 'OpenAI';
    }
    generate(prompt, md, sessionID) {
        prompt = prompt.trim();
        if ([OpenAIGenerateModel.GPT3Turbo, OpenAIGenerateModel.GPT4].includes(this.options.model)) {
            return this.generateChat(prompt, md, sessionID);
        }
        else {
            return this.generateDefault(prompt, md, sessionID);
        }
    }
    generateDefault(prompt, md, sessionID) {
        const res = apiCall(this.createAPI(apiType.Generate), generateReq(prompt, this.options, md?.stopSequences));
        return res.then(({ id, choices: c }) => ({
            id: id.toString(),
            sessionID: sessionID,
            query: prompt,
            values: c.map((v) => ({ id: v.index.toString(), text: v.text })),
            value() {
                return this.values[0].text;
            },
        }));
    }
    generateChat(prompt, md, sessionID) {
        const res = apiCall(this.createAPI(apiType.ChatGenerate), generateChatReq(prompt, this.options, md?.stopSequences));
        return res.then(({ id, choices: c }) => ({
            id: id.toString(),
            sessionID: sessionID,
            query: prompt,
            values: c.map((v) => ({
                id: v.index.toString(),
                text: v.message.content,
            })),
            value() {
                return this.values[0].text;
            },
        }));
    }
    embed(texts, sessionID) {
        if (texts.length > 96) {
            throw new Error('OpenAI limits embeddings input to 96 strings');
        }
        const overLimit = texts.filter((v) => v.length > 512);
        if (overLimit.length !== 0) {
            throw new Error('OpenAI limits embeddings input to 512 characters');
        }
        const embedReq = { input: texts, model: this.options.embedModel };
        const res = apiCall(this.createAPI(apiType.Embed), embedReq);
        return res.then((data) => ({
            id: '',
            sessionID,
            texts,
            model: data.model,
            embeddings: data.data.embeddings,
        }));
    }
    transcribe(file, prompt, language, sessionID) {
        const res = apiCallWithUpload(this.createAPI(apiType.Transcribe), generateAudioReq(this.options, prompt, language), file);
        return res.then((data) => ({
            duration: data.duration,
            segments: data.segments.map((v) => ({
                id: v.id,
                start: v.start,
                end: v.end,
                text: v.text,
            })),
            sessionID,
        }));
    }
    createAPI(name) {
        return {
            url: apiURL,
            key: this.apiKey,
            name,
            headers: {
                ...(this.orgID ? { 'OpenAI-Organization': this.orgID } : null),
            },
        };
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3BlbmFpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2FpL29wZW5haS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFRQSxPQUFPLEVBQU8sT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sUUFBUSxDQUFDO0FBTXpELE1BQU0sTUFBTSxHQUFHLDRCQUE0QixDQUFDO0FBRTVDLElBQUssT0FLSjtBQUxELFdBQUssT0FBTztJQUNWLG1DQUF3QixDQUFBO0lBQ3hCLDRDQUFpQyxDQUFBO0lBQ2pDLCtCQUFvQixDQUFBO0lBQ3BCLDhDQUFtQyxDQUFBO0FBQ3JDLENBQUMsRUFMSSxPQUFPLEtBQVAsT0FBTyxRQUtYO0FBRUQ7OztHQUdHO0FBQ0gsTUFBTSxDQUFOLElBQVksbUJBS1g7QUFMRCxXQUFZLG1CQUFtQjtJQUM3QixxQ0FBYyxDQUFBO0lBQ2QsNENBQXFCLENBQUE7SUFDckIsa0RBQTJCLENBQUE7SUFDM0IsOERBQXVDLENBQUE7QUFDekMsQ0FBQyxFQUxXLG1CQUFtQixLQUFuQixtQkFBbUIsUUFLOUI7QUFFRDs7O0dBR0c7QUFDSCxNQUFNLENBQU4sSUFBWSx1QkFJWDtBQUpELFdBQVksdUJBQXVCO0lBQ2pDLG1FQUF3QyxDQUFBO0lBQ3hDLG1FQUF3QyxDQUFBO0lBQ3hDLG1FQUF3QyxDQUFBO0FBQzFDLENBQUMsRUFKVyx1QkFBdUIsS0FBdkIsdUJBQXVCLFFBSWxDO0FBRUQ7OztHQUdHO0FBQ0gsTUFBTSxDQUFOLElBQVksaUJBR1g7QUFIRCxXQUFZLGlCQUFpQjtJQUMzQix1RUFBa0QsQ0FBQTtJQUNsRCxpRkFBNEQsQ0FBQTtBQUM5RCxDQUFDLEVBSFcsaUJBQWlCLEtBQWpCLGlCQUFpQixRQUc1QjtBQUVEOzs7R0FHRztBQUNILE1BQU0sQ0FBTixJQUFZLGdCQUVYO0FBRkQsV0FBWSxnQkFBZ0I7SUFDMUIsMENBQXNCLENBQUE7QUFDeEIsQ0FBQyxFQUZXLGdCQUFnQixLQUFoQixnQkFBZ0IsUUFFM0I7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